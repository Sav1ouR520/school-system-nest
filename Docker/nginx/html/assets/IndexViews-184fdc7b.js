import{d as F,o as x,a as Q,b as _,j as o,k as a,T as M,t as q,l as U,p as W,m as X,_ as S,q as Y,s as ee,u as z,x as E,c as V,y as r,z as C,A as T,B,C as te,D as re,E as oe,F as se,G as ne,e as ae}from"./index-249617c7.js";import{E as D,a as Z,b as N,c as K}from"./moment-176d9947.js";import{C as P,_ as le,a as j}from"./Captcha-2eed5264.js";import{_ as G}from"./message-2b362704.js";import{E as L}from"./el-message-60253f39.js";const ie=u=>(W("data-v-042cc2b5"),u=u(),X(),u),ue={"h-full":"","w-full":"","bg-gradient-to-r":"","from-green-500":"","to-blue-400":""},ce={"w-full":"","h-full":"","min-h-135":""},pe=ie(()=>_("div",{"w-full":"","h-full":"","bg-cover":"",class:"images"},null,-1)),de={absolute:"",flex:"","flex-col":"","justify-center":"","items-center":"","h-full":"","lg:w-135":"","w-screen":"","opacity-75":"","bg-white":"","top-0":"","right-0":"","min-h-135":""},me={"font-bold":"","text-center":"","text-10":"","m-0":""},_e={"mx-auto":"",class:"w-4/5"},ge=F({__name:"loginRegistrationItem",props:{title:null},setup(u){return(s,m)=>(x(),Q("div",ue,[_("div",ce,[o(M,{appear:"","appear-active-class":"animate__animated animate__backInLeft"},{default:a(()=>[pe]),_:1}),o(M,{appear:"","appear-active-class":"animate__animated animate__backInRight"},{default:a(()=>[_("div",de,[_("h1",me,q(u.title),1),_("div",_e,[U(s.$slots,"form",{},void 0,!0),U(s.$slots,"info",{},void 0,!0)])])]),_:3})])]))}});const fe=S(ge,[["__scopeId","data-v-042cc2b5"]]),we=u=>Y({url:"/email",data:{to:u},method:"POST"}),he={title:"登录",info:"还没有账号?",urlInfo:"点击注册",url:"login"},ve={title:"注册",info:"已有账号?",urlInfo:"点击登录",url:"register"},O=ee("SwitchFrom",{state:()=>({title:"",info:"",urlInfo:"",url:""}),actions:{setForm(u){u==="login"?this.$patch(he):u==="register"&&this.$patch(ve)}}}),be=F({__name:"registerFormItem",setup(u){const s=P(),m=O(),g=z(),i=E((()=>({username:"",account:"",password:"",repassword:"",captcha:""}))()),d={account:"",message:""};s.countDown();const w=async()=>{var e;await((e=g.value)==null?void 0:e.validateField("account"))&&(s.leftTime<=0?(we(i.account),s.countDown()):(s.emailErrorMeg=`还需等待${s.leftTime}s,才能重新发送验证码`,setTimeout(()=>{s.emailErrorMeg=""},1e3)))},l=re((t,e)=>{oe(t).then(n=>{n.action?(d.message="",e()):(d.message=n.message,e(new Error(n.message)))})},1e3),f=(t,e)=>{new RegExp(/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/).test(t)?d.account!=t?(d.account=t,l(t,e)):d.message?e(new Error(d.message)):e():e(new Error("不是邮箱格式"))},v=(t,e)=>{new RegExp(/(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9~!@&%#_]{8,30}$/).test(t)?e():e(new Error("密码需要由至少8位大小写、数字组合"))},h=(t,e)=>{t!==i.password?e(new Error("两次密码不一致")):e()},I=(t,e)=>{t.length<6?e(new Error("用户名长度至少需要6位")):t.length>20?e(new Error("用户名长度不能超过20位")):e()},k=E({username:[{required:!0,trigger:"blur",validator:(t,e,n)=>I(e,n)},{required:!0,trigger:"change",validator:(t,e,n)=>I(e,n)}],account:[{required:!0,message:"请输入邮箱",trigger:"blur"},{required:!0,message:"请输入邮箱",trigger:"change"},{required:!0,trigger:"blur",validator:(t,e,n)=>f(e,n)},{required:!0,trigger:"change",validator:(t,e,n)=>f(e,n)}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{required:!0,message:"请输入密码",trigger:"change"},{required:!0,trigger:"change",validator:(t,e,n)=>v(e,n)},{required:!0,trigger:"blur",validator:(t,e,n)=>v(e,n)}],repassword:[{required:!0,message:"请再输入一次密码",trigger:"blur"},{required:!0,message:"请再输入一次密码",trigger:"change"},{required:!0,trigger:"change",validator:(t,e,n)=>h(e,n)},{required:!0,trigger:"blur",validator:(t,e,n)=>h(e,n)}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{required:!0,message:"请输入验证码",trigger:"change"}]}),$=t=>{t&&(setTimeout(()=>{s.codeErrorMeg=""},0),t.validate(async e=>{if(e){const n=await te(i);n.action?(L({message:n.message,type:"success"}),m.setForm("login")):s.codeErrorMeg=n.message}}))};return(t,e)=>{const n=le,y=D,b=Z,R=G,A=j,H=K,J=N;return x(),V(J,{onSubmit:e[8]||(e[8]=C(()=>{},["prevent"])),rules:r(k),"status-icon":"",ref_key:"ruleFormRef",ref:g,model:r(i),size:"large","label-position":"top"},{default:a(()=>[o(b,{label:"密码",prop:"username"},{default:a(()=>[o(y,{modelValue:r(i).username,"onUpdate:modelValue":e[0]||(e[0]=p=>r(i).username=p),placeholder:"请输入用户名"},{prefix:a(()=>[o(n)]),_:1},8,["modelValue"])]),_:1}),o(b,{label:"邮箱",prop:"account",error:r(s).emailErrorMeg},{default:a(()=>[o(y,{modelValue:r(i).account,"onUpdate:modelValue":e[2]||(e[2]=p=>r(i).account=p),placeholder:"使用邮箱注册"},{prefix:a(()=>[o(R)]),append:a(()=>[_("a",{"cursor-pointer":"","no-underline":"","text-blue-500":"",onClick:e[1]||(e[1]=C(p=>w(),["prevent"]))},q(r(s).getCode),1)]),_:1},8,["modelValue"])]),_:1},8,["error"]),o(b,{label:"验证码",prop:"captcha",error:r(s).codeErrorMeg,"flex-grow":""},{default:a(()=>[o(y,{class:"no-radius",modelValue:r(i).captcha,"onUpdate:modelValue":e[3]||(e[3]=p=>r(i).captcha=p),placeholder:"请输入验证码",maxlength:"4"},{prefix:a(()=>[o(R)]),_:1},8,["modelValue"])]),_:1},8,["error"]),o(b,{label:"密码",prop:"password"},{default:a(()=>[o(y,{modelValue:r(i).password,"onUpdate:modelValue":e[4]||(e[4]=p=>r(i).password=p),placeholder:"密码需要由至少8位大小写、数字组合",type:"password",maxlength:"30"},{prefix:a(()=>[o(A)]),_:1},8,["modelValue"])]),_:1}),o(b,{label:"确认密码",prop:"repassword"},{default:a(()=>[o(y,{modelValue:r(i).repassword,"onUpdate:modelValue":e[5]||(e[5]=p=>r(i).repassword=p),placeholder:"再输入一次密码",type:"password",maxlength:"30",onKeyup:e[6]||(e[6]=T(p=>$(r(g)),["enter"]))},{prefix:a(()=>[o(A)]),_:1},8,["modelValue"])]),_:1}),o(b,null,{default:a(()=>[o(H,{type:"primary",onClick:e[7]||(e[7]=p=>$(r(g)))},{default:a(()=>[B("注册账号")]),_:1})]),_:1})]),_:1},8,["rules","model"])}}});const xe=S(be,[["__scopeId","data-v-e44e856b"]]),ye=["src"],Ve=F({__name:"loginFormItem",setup(u){const s=se(),m=P(),g=z(),c=E({account:"",password:"",captcha:""}),i=E({account:[{required:!0,message:"没有输入账号",trigger:"blur"},{required:!0,message:"没有输入账号",trigger:"change"}],password:[{required:!0,message:"没有输入密码",trigger:"blur"},{required:!0,message:"没有输入密码",trigger:"change"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{required:!0,message:"请输入验证码",trigger:"change"}]}),d=w=>{w&&w.validate(async l=>{if(l){const f=await ne(c);L({message:f.message,type:f.action?"success":"error"}),f.action?(m.reset(),s.push({name:"main"})):m.reset()}})};return(w,l)=>{const f=G,v=D,h=Z,I=j,k=K,$=N;return x(),V($,{onSubmit:l[6]||(l[6]=C(()=>{},["prevent"])),rules:r(i),"hide-required-asterisk":"",ref_key:"ruleFormRef",ref:g,model:r(c),"label-position":"top",size:"large"},{default:a(()=>[o(h,{label:"账号",prop:"account"},{default:a(()=>[o(v,{modelValue:r(c).account,"onUpdate:modelValue":l[0]||(l[0]=t=>r(c).account=t),placeholder:"请输入"},{prefix:a(()=>[o(f)]),_:1},8,["modelValue"])]),_:1}),o(h,{label:"密码",prop:"password"},{default:a(()=>[o(v,{modelValue:r(c).password,"onUpdate:modelValue":l[1]||(l[1]=t=>r(c).password=t),placeholder:"请输入密码",type:"password","show-password":""},{prefix:a(()=>[o(I)]),_:1},8,["modelValue"])]),_:1}),o(h,{label:"验证码",prop:"captcha",error:r(m).codeErrorMeg},{default:a(()=>[o(v,{class:"no-radius",modelValue:r(c).captcha,"onUpdate:modelValue":l[3]||(l[3]=t=>r(c).captcha=t),placeholder:"请输入验证码",maxlength:"4",onKeyup:l[4]||(l[4]=T(t=>d(r(g)),["enter"]))},{append:a(()=>[_("img",{onClick:l[2]||(l[2]=t=>r(m).reset()),src:r(m).url},null,8,ye)]),_:1},8,["modelValue"])]),_:1},8,["error"]),o(h,null,{default:a(()=>[o(k,{type:"primary",onClick:l[5]||(l[5]=t=>d(r(g)))},{default:a(()=>[B("登录")]),_:1})]),_:1})]),_:1},8,["rules","model"])}}});const Ie=S(Ve,[["__scopeId","data-v-c2d890ee"]]),$e={flex:"","m-0":"","text-3.5":"","font-bold":""},qe={"opacity-75":""},Re=F({__name:"IndexViews",setup(u){const s=O();s.setForm("login");const m=()=>{s.url==="login"?s.setForm("register"):s.url==="register"&&s.setForm("login")};return(g,c)=>{const i=Ie,d=xe,w=fe;return x(),V(w,{title:r(s).title},{form:a(()=>[r(s).url==="login"?(x(),V(i,{key:0})):r(s).url==="register"?(x(),V(d,{key:1})):ae("",!0)]),info:a(()=>[_("div",$e,[_("p",qe,q(r(s).info),1),_("a",{"text-center":"","text-blue-400":"","cursor-pointer":"",onClick:c[0]||(c[0]=l=>m())},q(r(s).urlInfo),1)])]),_:1},8,["title"])}}});export{Re as default};
