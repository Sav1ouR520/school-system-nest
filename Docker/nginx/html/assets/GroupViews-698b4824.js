import{o as w,a as z,b as o,d as H,a$ as E,t as L,y as e,l as ue,f as U,j as t,w as Y,v as Z,am as N,u as f,a3 as P,bP as be,c as O,k as n,B as G,b1 as Q,bQ as ye,x as X,z as J,bR as ce,a_ as T,bS as ze,e as de,bT as je,bU as Fe,aZ as oe,bV as xe,bW as Ae,aY as me,p as we,m as $e,_ as ke,F as ne,ba as Te,r as Ce,bX as Re,bY as Ge}from"./index-3c1f20cf.js";import{E as pe}from"./el-scrollbar-5e70c268.js";import{_ as le,E as se,c as te,a as Me,b as Ve,S as _e}from"./el-select-49268853.js";import{h as Le,c as K,E as fe,a as ge,b as ve}from"./moment-a900c884.js";import{E as he}from"./el-message-0b1a49f0.js";import{E as He,b as Ee,F as Ue,_ as Oe,c as qe,g as We,d as Ne}from"./filezip-710324b4.js";import{E as De,g as Pe}from"./el-progress-79455aff.js";import{E as Ye,a as Ze,b as Qe}from"./el-breadcrumb-item-77dfc1cf.js";const Xe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Je=o("path",{fill:"currentColor",d:"M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5l8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8z"},null,-1),Ke=[Je];function et(m,s){return w(),z("svg",Xe,Ke)}const tt={name:"ic-baseline-check-circle-outline",render:et},ot={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},nt=o("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8zm3.59-13L12 10.59L8.41 7L7 8.41L10.59 12L7 15.59L8.41 17L12 13.41L15.59 17L17 15.59L13.41 12L17 8.41z"},null,-1),lt=[nt];function st(m,s){return w(),z("svg",ot,lt)}const at={name:"ic-outline-cancel",render:st},rt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},it=o("path",{fill:"currentColor",d:"M19 12.998H5v-2h14z"},null,-1),ut=[it];function ct(m,s){return w(),z("svg",rt,ut)}const dt={name:"ic-outline-minus",render:ct},mt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pt=o("path",{fill:"currentColor",d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},null,-1),_t=[pt];function ft(m,s){return w(),z("svg",mt,_t)}const Ie={name:"ic-outline-add",render:ft},gt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vt=o("path",{fill:"currentColor",d:"M5 18.08V19h.92l9.06-9.06l-.92-.92z",opacity:".3"},null,-1),ht=o("path",{fill:"currentColor",d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM5.92 19H5v-.92l9.06-9.06l.92.92L5.92 19zM20.71 5.63l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83l3.75 3.75l1.83-1.83a.996.996 0 0 0 0-1.41z"},null,-1),bt=[vt,ht];function yt(m,s){return w(),z("svg",gt,bt)}const xt={name:"ic-twotone-create",render:yt},wt={"m-2":"","mt-0":"",flex:"","items-center":""},$t={"text-sm":"","flex-grow":""},kt={key:0,flex:"","items-center":"","justify-between":""},Ct={key:1,flex:"","items-center":"","justify-between":""},Be=H({__name:"groupMainCard",props:{name:null,num:null,modify:null,add:{type:Function},minus:null,sumbit:{type:Function},refresh:{type:Function}},emits:["change-modify-status","change-delete-status"],setup(m,{emit:s}){const l=m,a=E(),$=()=>{s("change-modify-status",!1),s("change-delete-status",!0)},g=()=>{s("change-modify-status",!1),s("change-delete-status",!1)},y=()=>{s("change-delete-status",!1),s("change-modify-status",!l.modify)};return(x,r)=>{const k=xt,B=Ie,i=dt,p=at,u=tt;return w(),z(N,null,[o("div",wt,[o("span",{"mr-4":"","font-bold":"","text-blue":"","cursor-pointer":"",onClick:r[0]||(r[0]=D=>m.refresh())},L(m.name),1),o("span",$t,L(m.num),1),e(a).userRole==="admin"?(w(),z("div",kt,[ue(x.$slots,"icon"),o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:r[1]||(r[1]=D=>y()),class:U(m.modify?"text-blue":"")},[t(k)],2),Y(o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:r[2]||(r[2]=D=>m.add())},[t(B)],512),[[Z,!m.minus]]),Y(o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:r[3]||(r[3]=D=>$())},[t(i)],512),[[Z,!m.minus]]),Y(o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:r[4]||(r[4]=D=>g())},[t(p)],512),[[Z,m.minus]]),Y(o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:r[6]||(r[6]=D=>g())},[t(u,{onClick:r[5]||(r[5]=D=>m.sumbit())})],512),[[Z,m.minus]])])):(w(),z("div",Ct,[ue(x.$slots,"base")]))]),ue(x.$slots,"list")],64)}}}),Mt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Vt=o("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zM7.35 18.5C8.66 17.56 10.26 17 12 17s3.34.56 4.65 1.5c-1.31.94-2.91 1.5-4.65 1.5s-3.34-.56-4.65-1.5zm10.79-1.38a9.947 9.947 0 0 0-12.28 0A7.957 7.957 0 0 1 4 12c0-4.42 3.58-8 8-8s8 3.58 8 8c0 1.95-.7 3.73-1.86 5.12z"},null,-1),Dt=o("path",{fill:"currentColor",d:"M12 6c-1.93 0-3.5 1.57-3.5 3.5S10.07 13 12 13s3.5-1.57 3.5-3.5S13.93 6 12 6zm0 5c-.83 0-1.5-.67-1.5-1.5S11.17 8 12 8s1.5.67 1.5 1.5S12.83 11 12 11z"},null,-1),It=[Vt,Dt];function Bt(m,s){return w(),z("svg",Mt,It)}const St={name:"ic-outline-account-circle",render:Bt},zt={flex:"","items-center":""},jt=["id"],Ft={flex:"","items-center":"","mb-4":"","h-10":"","border-black":"","bg-gray-200":"",rounded:"","border-2":"","text-black":""},At=o("span",{flex:"","justify-center":"","w-20":"","font-bold":"","border-r-2":"","border-gray":""},"姓名",-1),Tt={"ml-2":"",flex:"","justify-center":"","flex-grow":""},Rt={flex:"","items-center":"","mb-4":"","h-10":"","border-black":"","bg-gray-200":"",rounded:"","border-2":"","text-black":""},Gt=o("span",{flex:"","justify-center":"","w-20":"","font-bold":"","border-r-2":"","border-gray":""},"权限",-1),Lt={"ml-2":"",flex:"","justify-center":"","flex-grow":""},Ht={flex:"","items-center":"","h-10":"","border-black":"","bg-gray-200":"",rounded:"","border-2":"","text-black":""},Et=o("span",{flex:"","justify-center":"","w-20":"","font-bold":"","border-r-2":"","border-gray":""},"入群时间",-1),Ut={"ml-2":"",flex:"","justify-center":"","flex-grow":""},Ot=H({__name:"mainGroupCheckMember",props:{dialog:{type:Boolean},memberId:null},emits:["close-dialog"],setup(m,{emit:s}){const l=m,a=f(!1);P(l,async()=>{a.value=l.dialog,l.memberId!==""&&l.dialog&&x()});const $=()=>{s("close-dialog",!1),k.value=r()},g=()=>{$()},y=E(),x=()=>be(y.group.id,l.memberId).then(B=>k.value=B.data),r=()=>({id:"",name:"",groupId:"",role:"",joinTime:new Date,icon:"",userId:""}),k=f(r());return(B,i)=>{const p=le,u=se,D=K,j=te;return w(),O(j,{modelValue:e(a),"onUpdate:modelValue":i[1]||(i[1]=c=>Q(a)?a.value=c:null),width:"25rem","before-close":$,draggable:"","align-center":""},{header:n(({titleId:c})=>[o("div",zt,[t(u,{"mr-1":"",size:30,src:e(k).icon},{default:n(()=>[t(p,{"text-sm":""})]),_:1},8,["src"]),o("div",{id:c},"成员信息",8,jt)])]),footer:n(()=>[t(D,{"w-full":"",type:"primary",onClick:i[0]||(i[0]=c=>g())},{default:n(()=>[G("关闭")]),_:1})]),default:n(()=>[o("div",Ft,[At,o("span",Tt,L(e(k).name),1)]),o("div",Rt,[Gt,o("span",Lt,L(e(k).role),1)]),o("div",Ht,[Et,o("span",Ut,L(e(Le)(e(k).joinTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),_:1},8,["modelValue"])}}}),qt={flex:"","items-center":""},Wt=["id"],Nt=H({__name:"mainGroupModifyMember",props:{dialog:{type:Boolean},memberId:null},emits:["close-dialog","modify-member"],setup(m,{emit:s}){const l=m,a=f(!1);P(l,async()=>{a.value=l.dialog,l.memberId!==""&&l.dialog&&k()});const $=()=>{s("close-dialog",!1),r.role=r.name=""},g=()=>{$(),s("modify-member",!1)},y=E(),x=ye(),r=X({role:"",name:""}),k=()=>be(y.group.id,l.memberId).then(c=>{i.value=c.data,r.role=c.data.role,r.name=c.data.name}),i=f((()=>({id:"",name:"",groupId:"",role:"",joinTime:new Date,icon:"",userId:""}))()),p=f(),u=X({name:[{required:!0,message:"名字不能为空",trigger:"blur"}]}),D=c=>{c&&c.validate(async _=>{if(_){const F={id:i.value.id,groupId:i.value.groupId,name:i.value.name};let V=null;i.value.role!==r.role&&i.value.name!==r.name?V=ce({...F,role:i.value.role,name:i.value.name}):i.value.role!==r.role?V=ce({...F,role:i.value.role}):i.value.name!==r.name&&(V=ce({...F,name:i.value.name})),(i.value.role!==r.role||i.value.name!==r.name)&&(V==null||V.then(()=>{y.update={type:"member",time:new Date().valueOf()},T({message:"成功修改用户信息",type:"success"})}).catch(()=>T({message:"修改用户信息失败",type:"error"}))),g()}})},j=()=>{if(x.userId===i.value.userId)return!0;if(x.userId===y.group.owner)return!1;if(i.value.role==="admin")return!0};return(c,_)=>{const F=le,V=se,h=fe,v=ge,C=Me,M=Ve,b=ve,d=K,I=te;return w(),O(I,{modelValue:e(a),"onUpdate:modelValue":_[5]||(_[5]=S=>Q(a)?a.value=S:null),width:"25rem","before-close":$,draggable:"","align-center":""},{header:n(({titleId:S})=>[o("div",qt,[t(V,{"mr-1":"",size:30,src:e(i).icon},{default:n(()=>[t(F,{"text-sm":""})]),_:1},8,["src"]),o("div",{id:S},"修改成员信息",8,Wt)])]),footer:n(()=>[t(d,{type:"danger",onClick:_[3]||(_[3]=S=>g())},{default:n(()=>[G("取消")]),_:1}),t(d,{type:"primary",onClick:_[4]||(_[4]=S=>D(e(p)))},{default:n(()=>[G("修改")]),_:1})]),default:n(()=>[t(b,{"hide-required-asterisk":"","status-icon":"",rules:e(u),model:e(i),size:"large",ref_key:"ruleFormRef",ref:p,onSubmit:_[2]||(_[2]=J(()=>{},["prevent"]))},{default:n(()=>[t(v,{label:"姓名",prop:"name"},{default:n(()=>[t(h,{modelValue:e(i).name,"onUpdate:modelValue":_[0]||(_[0]=S=>e(i).name=S)},null,8,["modelValue"])]),_:1}),t(v,{label:"权限"},{default:n(()=>[t(M,{modelValue:e(i).role,"onUpdate:modelValue":_[1]||(_[1]=S=>e(i).role=S),placeholder:"权限","w-full":"",disabled:j()},{default:n(()=>[t(C,{label:"普通用户",value:"user"}),t(C,{label:"管理员",value:"admin"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])}}}),Pt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Yt=o("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},null,-1),Zt=[Yt];function Qt(m,s){return w(),z("svg",Pt,Zt)}const Xt={name:"ic-baseline-refresh",render:Qt},Jt={flex:"","h-8":""},Kt={flex:"","justify-center":"","flex-grow":""},eo=o("span",{"text-1":"","text-gray":"","pr-2":""},"[点击复制]",-1),to=o("div",{flex:"","justify-between":"","text-1":"","text-gray":""},[o("div",null,"目前只支持通过邀请码加入"),o("div",null,"[快发送给小伙伴加入吧]")],-1),oo=H({__name:"groupMainAddMember",props:{dialog:{type:Boolean}},emits:["close-dialog","add-member"],setup(m,{emit:s}){const l=m,a=f(!1),$=()=>je(x.group.id).then(p=>r.value=p.data.inviteCode);P(l,async()=>{a.value=l.dialog,l.dialog&&$()});const g=()=>{s("close-dialog",!1)},y=()=>{g(),s("add-member",!1)},x=E(),r=f(""),{copy:k}=ze({source:r}),B=()=>{k(),he({message:"复制邀请码成功",type:"success"})},i=async()=>{Fe(x.group.id).then(p=>r.value=p.data.inviteCode),he({message:"刷新邀请码成功",type:"success"})};return(p,u)=>{const D=Xt,j=K,c=te;return w(),O(c,{modelValue:e(a),"onUpdate:modelValue":u[3]||(u[3]=_=>Q(a)?a.value=_:null),title:"添加成员",width:"30rem","before-close":g,draggable:"","align-center":""},{footer:n(()=>[t(j,{"w-full":"",type:"primary",onClick:u[2]||(u[2]=_=>y())},{default:n(()=>[G("关闭")]),_:1})]),default:n(()=>[o("div",Jt,[o("div",{flex:"","flex-grow":"","justify-center":"","items-center":"","border-black":"","bg-gray-200":"",rounded:"","border-2":"","cursor-pointer":"","text-black":"",onClick:u[0]||(u[0]=_=>B())},[o("span",Kt,L(e(r)),1),eo]),e(x).userRole==="admin"?(w(),z("div",{key:0,flex:"","items-center":"","border-black":"","bg-gray-200":"",rounded:"","ml-2":"","w-8":"","border-2":"","justify-center":"","cursor-pointer":"",onClick:u[1]||(u[1]=_=>i())},[t(D,{"text-xl":"","text-black":""})])):de("",!0)]),to]),_:1},8,["modelValue"])}}}),no=["onClick"],lo={flex:"","h-10":"","flex-grow":"","px-2":"","justify-between":"","items-center":"","w-full":""},so={flex:"","items-center":""},ao={"ml-2":""},ro=H({__name:"groupMainMembers",setup(m){const s=E(),l=()=>xe(s.group.id).then(d=>{a.value=d.data,s.item.members=a.value.length}),a=f([]);l();const $=()=>{l().then(()=>T({message:"成功刷新成员",type:"success"})).catch(()=>{s.update={time:new Date().valueOf(),type:"all"},T({message:"刷新成员失败",type:"error"})})},g=_e(),y=f(!1),x=async()=>{g.hasDiglog=y.value=!0},r=d=>{g.hasDiglog=y.value=d},k=async d=>{d&&l()},B=f(0);s.$subscribe(async(d,I)=>{const S=I.update.time;I.update.type==="all"&&(F.value=h.value=!1),(I.update.type==="member"||I.update.type==="all")&&S>B.value&&(B.value=S,l())},{detached:!0,deep:!0});const i=f(""),p=f(!1),u=d=>{g.hasDiglog=p.value=!0,i.value=d},D=d=>{g.hasDiglog=p.value=d},j=f(!1),c=d=>{g.hasDiglog=j.value=!0,i.value=d},_=d=>{g.hasDiglog=j.value=d},F=f(!1),V=d=>{F.value=d},h=f(!1),v=f([]),C=d=>{h.value=d,v.value=[]},M=d=>{h.value?v.value.includes(d)?v.value=v.value.filter(I=>I!==d):v.value.push(d):F.value?u(d):c(d)},b=()=>{v.value.length!==0&&Ae(v.value).then(()=>{l(),T({message:"成功删除成员",type:"success"})}).catch(()=>T({message:"删除成员失败",type:"error"}))};return(d,I)=>{const S=oo,W=Nt,ee=Ot,A=le,ae=se,re=St,ie=pe,R=Ie,Se=Be;return w(),z(N,null,[t(S,{dialog:e(y),onCloseDialog:r,onAddMember:k},null,8,["dialog"]),t(W,{dialog:e(p),onCloseDialog:D,onModifyMember:k,memberId:e(i)},null,8,["dialog","memberId"]),t(ee,{dialog:e(j),onCloseDialog:_,memberId:e(i)},null,8,["dialog","memberId"]),t(Se,{name:"群成员",num:e(a).length,refresh:$,modify:e(F),add:x,minus:e(h),sumbit:b,onChangeDeleteStatus:C,onChangeModifyStatus:V},{list:n(()=>[t(ie,null,{default:n(()=>[(w(!0),z(N,null,oe(e(a),q=>(w(),z("div",{"items-center":"",border:"","border-transparent":"","hover:border-current":"","cursor-pointer":"",class:U([e(h)?"hover:bg-red-100":"",e(F)?"hover:bg-blue-100":"",e(v).includes(`${q.id}`)?"text-red":"text-black"]),key:q.id,onClick:Oo=>M(`${q.id}`)},[o("div",lo,[o("div",so,[t(ae,{size:30,src:q.icon?"/data/user/"+q.icon:null,onDragstart:I[0]||(I[0]=J(()=>{},["prevent"]))},{default:n(()=>[t(A,{"text-sm":""})]),_:2},1032,["src"]),o("span",ao,L(q.name),1)]),t(re,{"text-2xl":"",class:U(q.role==="admin"?"text-yellow":"")},null,8,["class"])])],10,no))),128))]),_:1})]),base:n(()=>[o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:I[1]||(I[1]=q=>x())},[t(R)])]),_:1},8,["num","modify","minus"])],64)}}}),io={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},uo=o("path",{fill:"currentColor",d:"M19 5v14H5V5h14m1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"},null,-1),co=[uo];function mo(m,s){return w(),z("svg",io,co)}const po={name:"ic-baseline-list-alt",render:mo},_o=m=>(we("data-v-7228fb12"),m=m(),$e(),m),fo={flex:"","flex-grow":"","items-center":"","justify-center":"","rounded-xl":""},go=_o(()=>o("p",null,"拖拽文件到此处或点击上传",-1)),vo={flex:"","justify-between":""},ho=H({__name:"groupMainAddTask",props:{dialog:{type:Boolean}},emits:["close-dialog","add-task"],setup(m,{emit:s}){const l=m,a=f(!1);P(l,()=>{a.value=l.dialog});const $=()=>{s("close-dialog",!1)},g=f(!1),y=f(),x=f([]),r=(V,h)=>{x.value=h},k=(V,h)=>{x.value=h},B=E(),i=me(),p=X({name:"",introduce:"",groupId:B.group.id,file:new Blob}),u=f(),D=X({name:[{required:!0,message:"组名不能为空",trigger:"blur"},{required:!0,message:"组名不能为空",trigger:"change"}],introduce:[{required:!0,message:"简介不能为空",trigger:"blur"},{required:!0,message:"简介不能为空",trigger:"change"}]}),j=()=>{y.value.clearFiles()},c=V=>{V&&(j(),V.resetFields(),g.value=!1,p.file=new Blob,$())},_=V=>{qe(p,g.value&&x.value.length!==0).then(()=>{T({message:`成功创建任务${p.name}`,type:"success"}),s("add-task",!0),B.update.type="task",B.update.time=i.time=new Date().valueOf()}).catch(()=>{T({message:`创建任务${p.name}失败`,type:"error"})}).finally(()=>c(V))},F=V=>{V&&V.validate(async h=>{if(h)if(g&&x.value.length!==0){const v=[];x.value.forEach(C=>{C.raw&&v.push(C.raw)}),p.file=await Ue(v),_(V)}else _(V)})};return(V,h)=>{const v=fe,C=ge,M=Oe,b=De,d=ve,I=He,S=Ee,W=K,ee=te;return w(),O(ee,{modelValue:e(a),"onUpdate:modelValue":h[7]||(h[7]=A=>Q(a)?a.value=A:null),title:"添加任务",width:"30rem","before-close":$,draggable:"","align-center":""},{footer:n(()=>[o("div",vo,[t(C,{label:"开启上传"},{default:n(()=>[t(S,{modelValue:e(g),"onUpdate:modelValue":h[4]||(h[4]=A=>Q(g)?g.value=A:null)},{default:n(()=>[t(I,{label:!0},{default:n(()=>[G("Yes")]),_:1}),t(I,{label:!1,onClick:h[3]||(h[3]=A=>j())},{default:n(()=>[G("No")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o("div",null,[t(W,{onClick:h[5]||(h[5]=A=>c(e(u)))},{default:n(()=>[G("取消")]),_:1}),t(W,{type:"primary",onClick:h[6]||(h[6]=A=>F(e(u)))},{default:n(()=>[G("确认")]),_:1})])])]),default:n(()=>[t(d,{"hide-required-asterisk":"","status-icon":"",rules:e(D),model:e(p),size:"large",ref_key:"ruleFormRef",ref:u,onSubmit:h[2]||(h[2]=J(()=>{},["prevent"]))},{default:n(()=>[t(C,{label:"任务名称",prop:"name"},{default:n(()=>[t(v,{modelValue:e(p).name,"onUpdate:modelValue":h[0]||(h[0]=A=>e(p).name=A)},null,8,["modelValue"])]),_:1}),t(C,{label:"任务简介",prop:"introduce"},{default:n(()=>[t(v,{modelValue:e(p).introduce,"onUpdate:modelValue":h[1]||(h[1]=A=>e(p).introduce=A),type:"textarea"},null,8,["modelValue"])]),_:1}),t(C,{label:"上传文件"},{default:n(()=>[t(b,{"flex-grow":"",ref_key:"upload",ref:y,action:"#","auto-upload":!1,disabled:!e(g),"file-list":e(x),"on-change":r,"on-remove":k,multiple:"",drag:""},{default:n(()=>[o("div",{flex:"","justify-between":"",class:U(e(g)?"text-blue":"")},[o("div",fo,[t(M,{"text-8.4":""}),go])],2)]),_:1},8,["disabled","file-list"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])}}});const bo=ke(ho,[["__scopeId","data-v-7228fb12"]]),yo=["onClick"],xo={flex:"","h-10":"","w-full":"","items-center":"","justify-center":""},wo={flex:"","flex-grow":"","pl-2":""},$o={flex:"","justify-center":"","pr-2":""},ko=H({__name:"groupMainTask",setup(m){const s=ne(),l=E(),a=()=>We(l.group.id).then(v=>{$.value=v.data,l.item.tasks=$.value.length?$.value.length:0}),$=f([]);a();const g=()=>{a().then(()=>T({message:"成功刷新任务",type:"success"})).catch(()=>{l.update={time:new Date().valueOf(),type:"all"},T({message:"刷新任务失败",type:"error"})})},y=f(0);l.$subscribe(async(v,C)=>{const M=C.update.time;C.update.type==="all"&&(p.value=D.value=c.value=!1),(C.update.type==="task"||C.update.type==="all")&&M>y.value&&(y.value=M,a())},{detached:!0,deep:!0});const x=_e(),r=f(!1),k=()=>{x.hasDiglog=r.value=!0},B=v=>{x.hasDiglog=r.value=v},i=()=>a(),p=f(!1),u=()=>{p.value=!p.value,D.value=!1,c.value=!1},D=f(!1),j=v=>{D.value=v,p.value=!1},c=f(!1),_=f([]),F=v=>{c.value=v,_.value=[]},V=v=>{c.value?_.value.includes(v)?_.value=_.value.filter(C=>C!==v):_.value.push(v):(s.push("/main/group/task"),l.click.id=v,l.click.type="task",D.value?l.click.status="modify":p.value?l.click.status="check":l.click.status="add")},h=()=>{if(_.value.length!==0){const v=_.value;Ne(_.value).then(()=>{v.includes(l.click.id)&&(s.push("/main/group"),l.click.id="",l.click.type=null),a();const C=me();l.update.type="group",l.update.time=C.time=new Date().valueOf(),T({message:"成功删除任务",type:"success"})}).catch(()=>T({message:"删除任务失败",type:"error"}))}};return(v,C)=>{const M=bo,b=po,d=pe,I=Be;return w(),z(N,null,[t(M,{dialog:e(r),onCloseDialog:B,onAddTask:i},null,8,["dialog"]),t(I,{name:"群任务",num:e($).length,refresh:g,modify:e(D),add:k,minus:e(c),sumbit:h,onChangeDeleteStatus:F,onChangeModifyStatus:j},{icon:n(()=>[o("div",{flex:"","items-center":"","justify-between":"","rounded-full":"","cursor-pointer":"",onClick:C[0]||(C[0]=S=>u()),class:U(e(p)?"text-blue":""),onDragstart:C[1]||(C[1]=J(()=>{},["prevent"]))},[t(b)],34)]),list:n(()=>[t(d,null,{default:n(()=>[(w(!0),z(N,null,oe(e($),S=>(w(),z("div",{"items-center":"",border:"","border-transparent":"","hover:border-current":"","cursor-pointer":"",class:U([e(c)?"hover:bg-red-100":"",e(D)?"hover:bg-blue-100":"",e(_).includes(S.id)?"text-red":"text-black"]),key:S.id,onClick:W=>V(S.id)},[o("div",xo,[o("div",wo,L(S.name),1),o("div",$o,L(S.file)+"/"+L(e(l).item.members),1)])],10,yo))),128))]),_:1})]),_:1},8,["num","modify","minus"])],64)}}}),Co={"flex-grow":"","m-4":"","mt-0":"","p-4":"","pb-12":"","rounded-xl":"","overflow-hidden":"","bg-white":"",class:"h-1/2"},Mo={"flex-grow":"","m-4":"","mt-0":"","p-4":"","pb-12":"","rounded-xl":"","overflow-hidden":"","bg-white":"",class:"h-1/2"},Vo=H({__name:"groupMainItem",setup(m){const s=E();s.getGroup();const l=f(0);s.$subscribe((r,k)=>{const B=k.update.time;(k.update.type==="group"||k.update.type==="all")&&B>l.value&&(l.value=B,s.getGroup())},{detached:!0,deep:!0});const a=ne(),$=f(a.currentRoute.value.name),g=Te();P(a.currentRoute,()=>{$.value=a.currentRoute.value.name});const y=()=>$.value==="group"&&g.width.value<=1024,x=()=>$.value!=="group"&&g.width.value<=1024;return(r,k)=>{const B=Ce("RouterView"),i=pe,p=ko,u=ro;return w(),z("div",{flex:"",class:U([y()?"flex-col":"flex-row"]),"overflow-hidden":"","flex-grow":""},[o("div",{"flex-grow":"","m-4":"",class:U([y()?"hidden":" mr-0",x()?"mr-4":""]),"mt-0":"","rounded-xl":"","bg-white":""},[t(i,{"p-4":""},{default:n(()=>[t(B)]),_:1})],2),o("div",{"flex-col":"","min-w-60":"",class:U([y()?"flex-grow":"w-1/3",x()?"hidden":"flex"])},[o("div",Co,[t(p)]),o("div",Mo,[t(u)])],2)],2)}}}),Do=m=>(we("data-v-12470825"),m=m(),$e(),m),Io={flex:""},Bo={flex:"","w-full":"","items-center":""},So=Do(()=>o("p",{"text-blue":""},"拖拽文件或点击上传['可选']",-1)),zo={"ml-2":"",flex:"","items-center":""},jo={class:"w-full h-80 mt-5 rounded overflow-hidden"},Fo={flex:"","justify-between":""},Ao=H({__name:"groupHeaderModifyGroup",props:{dialog:{type:Boolean}},emits:["close-dialog","add-group"],setup(m,{emit:s}){const l=m,a=f(!1);P(l,async()=>{a.value=l.dialog,l.dialog&&(y.getGroup(),r(),c.value={name:y.group.name,id:y.group.id,owner:y.group.owner})});const $=()=>{s("close-dialog",!1)},g=ne(),y=E(),x=f([]),r=()=>{xe(y.group.id).then(M=>x.value=M.data)},k=f(),B=M=>{k.value.clearFiles();const b=M[0];b.uid=Pe(),k.value.handleStart(b)},i=M=>{if(M.raw){let b=new FileReader;b.readAsDataURL(M.raw),b.onload=d=>{var I;u.img=(I=d.target)==null?void 0:I.result}}},p=f(),u=X({img:"",outputSize:1,outputType:"png",canScale:!0,autoCrop:!0,info:!1,autoCropWidth:200,autoCropHeight:200,canMoveBox:!1,fixedBox:!0,canMove:!0,centerBox:!0,fixed:!0,mode:"cover"}),D=()=>{u.img="",k.value.clearFiles()},j=()=>({id:"",name:"",owner:""}),c=f(j()),_=f(),F=X({name:[{required:!0,message:"组名不能为空",trigger:"blur"},{required:!0,message:"组名不能为空",trigger:"change"}]}),V=()=>{Re(y.group.id).then(()=>{T({message:`成功删除组${c.value.name}`,type:"success"}),y.$reset(),y.update={time:new Date().valueOf(),type:"group"},g.push("/main")}).catch(()=>T({message:`删除组${c.value.name}失败`,type:"error"}))},h=M=>{M&&(D(),M.resetFields(),$())},v=(M,b)=>{Ge({...c.value,icon:b}).then(()=>{T({message:`成功修改组${c.value.name}`,type:"success"}),s("add-group",new Date().valueOf()),y.getGroup(),y.update={time:new Date().valueOf(),type:"group"};const d=me();d.time=new Date().valueOf()}).catch(()=>T({message:`修改组${c.value.name}失败`,type:"error"})).finally(()=>{h(M),c.value=j()})},C=M=>{M&&M.validate(async b=>{b&&(u.img!==""?await p.value.getCropBlob(d=>{const I=new File([d],"clipImage"+d.type.split("/")[1],{type:d.type});v(M,I)}):v(M))})};return(M,b)=>{const d=fe,I=ge,S=Me,W=Ve,ee=De,A=K,ae=Ce("vueCropper"),re=ve,ie=te;return w(),O(ie,{modelValue:e(a),"onUpdate:modelValue":b[6]||(b[6]=R=>Q(a)?a.value=R:null),title:"修改组",width:"30rem","before-close":$,draggable:"","align-center":""},{footer:n(()=>[o("div",Fo,[o("div",null,[t(A,{type:"danger",onClick:b[3]||(b[3]=R=>V())},{default:n(()=>[G("删除组")]),_:1})]),o("div",null,[t(A,{onClick:b[4]||(b[4]=R=>h(e(_)))},{default:n(()=>[G("取消修改")]),_:1}),t(A,{type:"primary",onClick:b[5]||(b[5]=R=>C(e(_)))},{default:n(()=>[G("确认修改")]),_:1})])])]),default:n(()=>[t(re,{"hide-required-asterisk":"","status-icon":"",rules:e(F),model:e(c),size:"large",ref_key:"ruleFormRef",ref:_,onSubmit:b[2]||(b[2]=J(()=>{},["prevent"]))},{default:n(()=>[o("div",Io,[t(I,{label:"组名",prop:"name"},{default:n(()=>[t(d,{modelValue:e(c).name,"onUpdate:modelValue":b[0]||(b[0]=R=>e(c).name=R),maxlength:"20"},null,8,["modelValue"])]),_:1}),t(I,{label:"组长","ml-4":""},{default:n(()=>[t(W,{modelValue:e(c).owner,"onUpdate:modelValue":b[1]||(b[1]=R=>e(c).owner=R),"w-full":"",placeholder:"[组长转交可选项]"},{default:n(()=>[(w(!0),z(N,null,oe(e(x),R=>(w(),O(S,{key:R.id,label:R.name,value:R.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),t(I,{label:"头像"},{default:n(()=>[o("div",Bo,[t(ee,{action:"#",limit:1,"auto-upload":!1,drag:!0,accept:"image/*",ref_key:"upload",ref:k,"on-exceed":B,"on-change":i,"show-file-list":!1,"flex-grow":""},{default:n(()=>[So]),_:1},512),Y(o("div",zo,[t(A,{type:"primary",onClick:D},{default:n(()=>[G("取消图片")]),_:1})],512),[[Z,e(u).img!==""]])]),Y(o("div",jo,[t(ae,{ref_key:"cropper",ref:p,img:e(u).img,outputSize:e(u).outputSize,outputType:e(u).outputType,canScale:e(u).canScale,autoCrop:e(u).autoCrop,autoCropWidth:e(u).autoCropWidth,autoCropHeight:e(u).autoCropHeight,canMoveBox:e(u).canMoveBox,canMove:e(u).canMove,centerBox:e(u).centerBox,info:e(u).info,fixedBox:e(u).fixedBox,fixed:e(u).fixed,mode:e(u).mode},null,8,["img","outputSize","outputType","canScale","autoCrop","autoCropWidth","autoCropHeight","canMoveBox","canMove","centerBox","info","fixedBox","fixed","mode"])],512),[[Z,e(u).img!==""]])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])}}});const To=ke(Ao,[["__scopeId","data-v-12470825"]]),Ro={"m-4":"","p-4":"","rounded-xl":"","bg-white":""},Go={flex:"","items-center":""},Lo={"font-bold":""},Ho={key:0,flex:"","items-center":"","mr-1.5":""},Eo=H({__name:"groupHeaderItem",setup(m){const s=E(),l=ye(),a=ne(),$=_e(),g=f(!1),y=f(0),x=()=>{$.hasDiglog=g.value=!0},r=j=>{$.hasDiglog=g.value=j},k=j=>{y.value=j},B=()=>a.currentRoute.value.matched.slice(-2)[0].path,i=()=>a.currentRoute.value.matched.slice(-1)[0].path.split("/").slice(1),p=f(i()),u=f(B()),D=()=>a.push(u.value);return P(a.currentRoute,()=>{u.value=B(),p.value=i()}),(j,c)=>{const _=Ye,F=Ze,V=le,h=se,v=K,C=To,M=Qe;return w(),z("div",Ro,[t(M,{onBack:c[2]||(c[2]=b=>D())},{breadcrumb:n(()=>[t(F,{separator:"/"},{default:n(()=>[(w(!0),z(N,null,oe(e(p),(b,d)=>(w(),O(_,{key:d},{default:n(()=>[G(L(b[0].toUpperCase()+b.slice(1)),1)]),_:2},1024))),128))]),_:1})]),content:n(()=>[o("div",Go,[t(h,{class:"mr-3",size:32,src:e(s).group.icon?"/data/group/"+e(s).group.icon:null,onDragstart:c[0]||(c[0]=J(()=>{},["prevent"]))},{default:n(()=>[t(V,{"text-xl":""})]),_:1},8,["src"]),o("span",Lo,L(e(s).group.name),1)])]),extra:n(()=>[e(s).group.owner===e(l).userId?(w(),z("div",Ho,[t(v,{type:"primary",onClick:c[1]||(c[1]=b=>x())},{default:n(()=>[G("设置")]),_:1})])):de("",!0),t(C,{dialog:e(g),onCloseDialog:r,onAddGroup:k},null,8,["dialog"])]),_:1})])}}}),Uo={key:0,flex:"","flex-col":"","flex-grow":""},Jo=H({__name:"GroupViews",setup(m){const s=E();return(l,a)=>{const $=Eo,g=Vo;return e(s).group.id!==""?(w(),z("div",Uo,[(w(),O($,{key:e(s).group.id})),(w(),O(g,{key:e(s).group.id}))])):de("",!0)}}});export{Jo as default};
