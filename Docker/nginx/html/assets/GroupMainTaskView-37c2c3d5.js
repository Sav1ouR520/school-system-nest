import{f as B,g as C,_ as F,a as I}from"./modifyTaskItem-bc58ed4f.js";import{d as v,aY as M,a_ as w,F as $,u as x,o as e,a as c,b as t,t as d,y as o,am as y,aZ as G,e as k,b1 as h,c as p}from"./index-249617c7.js";import{h as b}from"./moment-176d9947.js";import"./el-progress-d3739031.js";import"./filezip-5b0b7291.js";const H={flex:"","items-center":"","mx-2":"","mb-4":"","h-10":""},O={flex:"","items-center":"","flex-grow":"","font-bold":"","h-8":""},P=t("span",{"text-2xl":""},"任务名:",-1),N={flex:"","items-center":"","mt-1":"","px-1":"","ml-2":"","h-8":"","bg-black":"",rounded:"","text-white":""},V={"font-bold":""},E={flex:"","items-center":"","text-xs":"","px-1":"","ml-2":"","h-8":"","bg-black":"",rounded:"","text-white":""},S=t("span",null,"创建者:",-1),j={"font-bold":""},L={flex:"","items-center":"","text-xs":"","px-1":"","ml-2":"","h-8":"","bg-black":"",rounded:"","text-white":""},R=t("span",null,"时间:",-1),Z={"font-bold":""},q={"pt-0":"","flex-grow":"","border-4":"","m-2":"",rounded:""},z={"w-full":""},A=t("thead",{"h-12":""},[t("tr",{align:"center","text-4":""},[t("th",{"pl-4":"",align:"left"},"用户"),t("th",null,"文件"),t("th",null,"上传时间"),t("th",null,"审批")])],-1),J={align:"center","font-bold":"","h-12":""},K={"pl-4":"",align:"left"},Q={key:0},U=["onClick"],W={key:1},X={key:2},tt=["onClick"],et={key:3,colspan:"3"},ot={align:"center","h-12":""},nt={"font-bold":""},st=t("td",{colspan:"3"},null,-1),at=v({__name:"mainGroupCheckFile",setup(D){const r=M(),s=w(),u=$(),_=()=>{B(s.click.id).then(i=>a.value=i.data).catch(async()=>{u.push("/main/group"),s.update={time:new Date().valueOf(),type:"all"},h({message:"权限不足/任务不存在",type:"error"})})},a=x({member:[],task:{id:"",name:"",introduce:"",memberId:"",groupId:"",activeStatue:!0,dataPath:null,createTime:new Date,member:{id:"",name:"",groupId:"",userId:"",role:"admin",joinTime:new Date,icon:""}}});_();const m=i=>{window.location.href="/data/file/"+i},T=(i,l)=>{C(i).then(()=>{_(),s.update={time:new Date().valueOf(),type:"task"},r.time=new Date().valueOf(),h({message:`成功退回${l}提交的文件`,type:"success"})}).catch(()=>{u.push("/main/group"),s.update={time:new Date().valueOf(),type:"all"},h({message:"权限不足",type:"error"})})},f=x(s.click.id);return s.$subscribe(async(i,l)=>{l.click.type==="task"&&l.click.status==="check"&&f.value!==l.click.id&&(f.value=s.click.id,_())},{detached:!0,deep:!0}),(i,l)=>{var g;return e(),c(y,null,[t("div",H,[t("div",O,[P,t("div",N,[t("span",V,d(o(a).task.name),1)])]),t("div",E,[S,t("span",j,d(o(a).task.member.name),1)]),t("div",L,[R,t("span",Z,d(o(b)(o(a).task.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),t("div",q,[t("table",z,[A,t("tbody",J,[(e(!0),c(y,null,G(o(a).member,n=>(e(),c("tr",{key:n.id},[t("td",K,d(n.name),1),n.file.length!==0?(e(),c("td",Q,[t("a",{"cursor-pointer":"","text-blue":"",onClick:Y=>m(n.file[0].filePath)},"下载",8,U)])):k("",!0),n.file.length!==0?(e(),c("td",W,d(o(b)(n.file[0].uploadTime).format("YYYY-MM-DD HH:mm:ss")),1)):k("",!0),n.file.length!==0?(e(),c("td",X,[t("a",{"cursor-pointer":"","text-blue":"",onClick:Y=>T(n.file[0].id,n.name)},"退回",8,tt)])):(e(),c("td",et,"没 有 上 传"))]))),128))]),t("tfoot",ot,[t("tr",nt,[st,t("td",null,"总计 "+d((g=o(a))==null?void 0:g.member.length)+" 人",1)])])])])],64)}}}),_t=v({__name:"GroupMainTaskView",setup(D){const r=w();return(s,u)=>{const _=F,a=I,m=at;return o(r).click.status==="modify"?(e(),p(_,{key:0})):o(r).click.status==="add"?(e(),p(a,{key:1})):o(r).click.status==="check"?(e(),p(m,{key:2})):k("",!0)}}});export{_t as default};
